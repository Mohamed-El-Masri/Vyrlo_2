<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile - Vyrlo</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Main CSS -->
    <link rel="stylesheet" href="/css/main/style.css">
   <!-- Add listings -->
   <link rel="stylesheet" href="/css/components/listing-wizard.css">
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <!-- Toast -->
    <link rel="stylesheet" href="/css/components/toast.css">

    <!-- Page CSS -->
    <link rel="stylesheet" href="/css/pages/profile.css">
</head>
<body>
    <!-- Header Container -->
    <div id="headerContainer"></div>

    <main>
        <!-- Enhanced Hero Section -->
        <div class="breadcrumb-section vr-profile-hero">
            <div class="layer"></div>
            <div class="content-data container">
                <h2 class="vr-animate-slide-down">Hello, <span id="profileName">....</span></h2>
                <p class="vr-animate-fade-in vr-delay-1">Manage your personal information and account settings</p>
                <!-- Status Badge -->
                <div class="vr-profile-status vr-animate-fade-in vr-delay-2">
                    <span class="vr-badge vr-badge--success">
                        <i class="fa-solid fa-circle-check"></i> Verified Account
                    </span>
                </div>
            </div>
        </div>

        <div class="container-fluid">
            <div class="row">
                <!-- Enhanced Sidebar -->
                <section class="col-md-4 col-lg-3 p-3">
                    <div class="block vr-profile vr-profile-card">
                        <div class="profile-info vr-profile__info">
                            <div class="vr-avatar-container">
                                <img src="/images/defaults/default-avatar.png" alt="profile image" class="profile-image vr-avatar" id="profileAvatar">
                                <div class="vr-avatar-edit">
                                    <label for="avatarUpload">
                                        <i class="fa-solid fa-camera"></i>
                                    </label>
                                    <input type="file" id="avatarUpload" class="d-none">
                                </div>
                            </div>
                            <div class="vr-profile__details">
                                <h4 class="name" id="profileDisplayName">User Name</h4>
                                <p class="location" id="profileLocation"><i class="fa-solid fa-location-dot"></i> Location</p>
                                <p class="vr-profile-joindate"><i class="fa-regular fa-calendar"></i> Member since <span id="joinDate">January 2023</span></p>
                            </div>
                            <div class="vr-profile-stats">
                                <div class="vr-stat">
                                    <span class="vr-stat-number" id="listingsCount">0</span>
                                    <span class="vr-stat-label">Listings</span>
                                </div>
                                <div class="vr-stat">
                                    <span class="vr-stat-number" id="favoritesCount">0</span>
                                    <span class="vr-stat-label">Saved</span>
                                </div>
                            </div>
                        </div>
                        <ul class="vr-profile-menu">
                            <li class="profile-item" data-page="profile">
                                <a href="/pages/profile.html">
                                    <i class="fa-regular fa-user"></i>
                                    My Profile
                                </a>
                            </li>
                            <li class="profile-item" data-page="addListing">
                                <a href="#" onclick="loadAddListingComponent(); return false;">
                                    <i class="fa-solid fa-plus"></i>
                                    Add Listing
                                </a>
                            </li>
                            <li class="profile-item" data-page="userListings">
                                <a href="/pages/userListings.html">
                                    <i class="fa-solid fa-list"></i>
                                    My Listings
                                </a>
                            </li>
                            <li class="profile-item" data-page="changePassword">
                                <a href="/pages/change-password.html">
                                    <i class="fa-solid fa-lock"></i>
                                    Change Password
                                </a>
                            </li>
                            <li class="profile-item log-out">
                                <a href="javascript:void(0)" id="logoutLink">
                                    <i class="fa-solid fa-power-off"></i>
                                    Log Out
                                </a>
                            </li>
                        </ul>
                    </div>
                </section>

                <!-- Enhanced Content Area -->
                <section class="col-md-8 col-lg-9 p-3">
                    <div class="dashboard block p-4 vr-profile__form vr-animate-scale-in">
                        <div class="vr-profile-header">
                            <h5><i class="fa-solid fa-user-gear"></i> My Account</h5>
                            <span class="vr-badge vr-badge--primary">Personal Info</span>
                        </div>
                        
                        <form id="editProfileForm" method="POST">
                            <div class="row p-2">
                                <!-- Personal Information Section -->
                                <div class="vr-form-section">
                                    <h6 class="vr-form-section-title"><i class="fa-solid fa-user-shield"></i> Personal Details</h6>
                                    
                                    <div class="input vr-form-group">
                                        <label for="title">Title</label>
                                        <input type="text" id="title" name="title" class="vr-input">
                                        <span class="error-message" id="titleError"></span>
                                    </div>
                                    
                                    <div class="input vr-form-group">
                                        <label for="phoneNumber">Phone</label>
                                        <div class="vr-input-icon">
                                            <i class="fa-solid fa-phone"></i>
                                            <input type="text" id="phoneNumber" name="phoneNumber" class="vr-input">
                                        </div>
                                        <span class="error-message" id="phoneError"></span>
                                    </div>
                                    
                                    <div class="input vr-form-group">
                                        <label for="bio">About Me</label>
                                        <textarea id="bio" name="about" class="vr-input" placeholder="Tell us about yourself..."></textarea>
                                        <span class="error-message" id="bioError"></span>
                                    </div>
                                </div>
                                
                                <!-- Address Section -->
                                <div class="vr-form-section">
                                    <h6 class="vr-form-section-title"><i class="fa-solid fa-map-location-dot"></i> Address Information</h6>
                                    
                                    <div class="input vr-form-group">
                                        <label for="Address">Address</label>
                                        <div class="vr-input-icon">
                                            <i class="fa-solid fa-location-dot"></i>
                                            <input type="text" id="Address" name="address" class="vr-input">
                                        </div>
                                        <span class="error-message" id="AddressError"></span>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="input vr-form-group">
                                                <label for="City">City</label>
                                                <input type="text" id="City" name="city" class="vr-input">
                                                <span class="error-message" id="CityError"></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="input vr-form-group">
                                                <label for="State">State</label>
                                                <input type="text" id="State" name="state" class="vr-input">
                                                <span class="error-message" id="StateError"></span>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="input vr-form-group">
                                                <label for="zipCode">Zip Code</label>
                                                <input type="text" id="zipCode" name="zipCode" class="vr-input">
                                                <span class="error-message" id="zipCodeError"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Social Media Section -->
                                <div class="vr-form-section">
                                    <h6 class="vr-form-section-title"><i class="fa-solid fa-share-nodes"></i> Social Media</h6>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="input vr-form-group">
                                                <label for="facebook"><i class="fa-brands fa-facebook" style="color: #1877F2;"></i> Facebook</label>
                                                <div class="vr-input-icon">
                                                    <i class="fa-brands fa-facebook"></i>
                                                    <input type="url" value="" id="facebook" name="facebook" class="vr-input" placeholder="https://facebook.com/username">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="input vr-form-group">
                                                <label for="instagram"><i class="fa-brands fa-instagram" style="color: #E1306C;"></i> Instagram</label>
                                                <div class="vr-input-icon">
                                                    <i class="fa-brands fa-instagram"></i>
                                                    <input type="url" value="" id="instagram" name="instagram" class="vr-input" placeholder="https://instagram.com/username">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="vr-form-actions">
                                <button type="button" class="vr-btn vr-btn--outline mr-2">Cancel</button>
                                <button type="submit" class="save-changes vr-btn vr-btn--primary">
                                    <i class="fa-solid fa-floppy-disk"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="vr-profile__content">
                        <!-- Profile content will be here -->
                        <div id="addListingContainer"></div>
                    </div>
                </section>
            </div>
        </div>
        <div id="addListingContainer"></div>
    </main>

    <!-- Footer Container -->
    <div id="footerContainer"></div>

    <!-- Toast Container -->
    <div class="vr-toast-container" id="toastContainer"></div>
    <!-- Core Services -->
    <script src="/js/services/api.service.js"></script>
    <script src="/js/services/toast.service.js"></script>
    <script src="/js/core/utils.js"></script>
    <script src="/js/core/componentLoader.js"></script>
    <script src="/js/services/auth.service.js"></script>
    <script src="/js/pages/profile.js"></script>

    <!-- listing wizard -->
    
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Initialize listing wizard after content loads
        document.addEventListener('DOMContentLoaded', () => {
            // Listen for profile content changes
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.addedNodes.length) {
                        const wizardForm = document.getElementById('listingWizardForm');
                        if (wizardForm && !window.listingWizard) {
                            window.listingWizard = new ListingWizard();
                        }
                    }
                });
            });

            // Observe profile content area
            const profileContent = document.querySelector('.vr-profile-content');
            if (profileContent) {
                observer.observe(profileContent, { childList: true, subtree: true });
            }
        });

        function loadAddListingComponent() {
            // Remove active class from all items
            document.querySelectorAll('.profile-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to Add Listing menu item
            document.querySelector('[data-page="addListing"]').classList.add('active');
            
            // Hide other content
            const mainContent = document.querySelector('.vr-profile__form:not(.vr-listing-wizard)');
            if (mainContent) {
                mainContent.style.display = 'none';
            }
            
            // Load the component
            fetch('/components/profile/addListing.html')
                .then(response => response.text())
                .then(html => {
                    const container = document.getElementById('addListingContainer');
                    container.innerHTML = html;
                    container.style.display = 'block';
                    
                    // Initialize listing wizard
                    if (typeof ListingWizard !== 'undefined') {
                        window.listingWizard = new ListingWizard();
                    }
                    
                    // Update page title
                    const pageTitle = document.querySelector('.vr-profile-header h5');
                    if (pageTitle) {
                        pageTitle.innerHTML = '<i class="fa-solid fa-plus-circle"></i> Add New Listing';
                    }
                })
                .catch(error => {
                    console.error('Error loading component:', error);
                    window.toastService?.error('Failed to load Add Listing component');
                });
        }
    </script>
    <script src="/js/components/listingWizard.js"></script>
    <script src="/js/pages/profile/add-listing.js"></script>
   
</body>
</html>